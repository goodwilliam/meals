<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <title>Weekly Meals</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --green:      #2d6a4f;
      --green-light:#d8f3dc;
      --green-mid:  #52b788;
      --bg:         #f0f4f1;
      --card:       #ffffff;
      --text:       #1a1a1a;
      --muted:      #6b7280;
      --border:     #e5e7eb;
      --red-bg:     #fee2e2;   --red-text:   #b91c1c;
      --yellow-bg:  #fef9c3;   --yellow-text:#854d0e;
      --veggie-bg:  #dcfce7;   --veggie-text:#15803d;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding-bottom: 90px;
    }

    header {
      background: var(--green);
      color: white;
      padding: 24px 16px 20px;
      text-align: center;
    }
    header h1 { font-size: 1.5rem; font-weight: 700; letter-spacing: -0.02em; }
    header p  { font-size: 0.85rem; opacity: 0.75; margin-top: 4px; }

    .cards { padding: 14px 12px 0; display: flex; flex-direction: column; gap: 10px; }

    .card {
      background: var(--card);
      border-radius: 14px;
      padding: 14px 14px 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.07);
    }
    .card.rolling { animation: pop 0.25s ease; }
    @keyframes pop {
      0%   { transform: scale(1); }
      50%  { transform: scale(0.97); }
      100% { transform: scale(1); }
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .day-name { font-weight: 700; font-size: 1rem; color: var(--green); }
    .card-actions { display: flex; align-items: center; gap: 6px; }

    .reroll-btn {
      background: var(--green-light);
      color: var(--green);
      border: none;
      padding: 5px 13px;
      border-radius: 20px;
      font-size: 0.82rem;
      font-weight: 600;
      cursor: pointer;
    }
    .reroll-btn:active { background: #b7e4c7; }

    .fav-btn {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      padding: 2px 4px;
      opacity: 0.3;
      transition: opacity 0.15s, transform 0.15s;
    }
    .fav-btn.active { opacity: 1; }
    .fav-btn:active { transform: scale(1.35); }

    .meal-rows { display: flex; flex-direction: column; gap: 7px; }
    .meal-row  { display: flex; align-items: center; gap: 8px; font-size: 0.92rem; }

    .tag {
      font-size: 0.68rem;
      font-weight: 700;
      padding: 3px 8px;
      border-radius: 10px;
      min-width: 48px;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      flex-shrink: 0;
    }
    .tag-p { background: var(--red-bg);    color: var(--red-text); }
    .tag-s { background: var(--yellow-bg); color: var(--yellow-text); }
    .tag-v { background: var(--veggie-bg); color: var(--veggie-text); }
    .meal-name { flex: 1; }

    .cook-note {
      margin-top: 10px;
      padding-top: 9px;
      border-top: 1px solid var(--border);
      font-size: 0.78rem;
      color: var(--muted);
      line-height: 1.5;
    }
    .yt-link {
      display: inline-flex;
      align-items: center;
      gap: 3px;
      background: var(--bg);
      color: var(--green);
      border: 1px solid var(--green-mid);
      border-radius: 12px;
      padding: 3px 10px;
      font-size: 0.75rem;
      font-weight: 600;
      text-decoration: none;
      margin-top: 6px;
    }
    .yt-link:active { opacity: 0.7; }

    /* â”€â”€ Favorites â”€â”€ */
    .fav-section {
      margin: 12px 12px 0;
      background: var(--card);
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.07);
      display: none;
    }
    .fav-section.open { display: block; }
    .fav-header {
      background: #9f1239;
      color: white;
      padding: 12px 16px;
      font-size: 1rem;
      font-weight: 700;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .fav-clear {
      font-size: 0.78rem;
      opacity: 0.8;
      background: none;
      border: 1px solid rgba(255,255,255,0.5);
      color: white;
      padding: 3px 10px;
      border-radius: 12px;
      cursor: pointer;
    }
    .fav-body { padding: 12px 16px; display: flex; flex-direction: column; gap: 4px; }
    .fav-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 0;
      border-bottom: 1px solid var(--border);
    }
    .fav-item:last-child { border-bottom: none; }
    .fav-item-info { flex: 1; }
    .fav-item-protein { font-size: 0.9rem; font-weight: 600; margin-bottom: 2px; }
    .fav-item-sides   { font-size: 0.78rem; color: var(--muted); }
    .fav-remove {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--muted);
      padding: 4px 6px;
      flex-shrink: 0;
    }
    .fav-empty { text-align: center; color: var(--muted); font-size: 0.85rem; padding: 20px 0; }

    /* â”€â”€ Grocery â”€â”€ */
    .grocery-wrap {
      margin: 12px 12px 0;
      background: var(--card);
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.07);
      display: none;
    }
    .grocery-wrap.open { display: block; }
    .grocery-header {
      background: var(--green);
      color: white;
      padding: 12px 16px;
      font-size: 1rem;
      font-weight: 700;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .clear-checks {
      font-size: 0.78rem;
      opacity: 0.8;
      background: none;
      border: 1px solid rgba(255,255,255,0.5);
      color: white;
      padding: 3px 10px;
      border-radius: 12px;
      cursor: pointer;
    }
    .grocery-body { padding: 14px 16px; }
    .g-category { margin-bottom: 16px; }
    .g-category:last-child { margin-bottom: 0; }
    .g-category h3 {
      font-size: 0.72rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--muted);
      margin-bottom: 8px;
    }
    .g-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 6px 0;
      font-size: 0.92rem;
      border-bottom: 1px solid var(--border);
      cursor: pointer;
    }
    .g-item:last-child { border-bottom: none; }
    .g-item.checked { opacity: 0.4; text-decoration: line-through; }
    .g-item input { width: 18px; height: 18px; accent-color: var(--green); cursor: pointer; }

    /* â”€â”€ Bottom bar â”€â”€ */
    .bottom-bar {
      position: fixed;
      bottom: 0; left: 0; right: 0;
      background: var(--card);
      border-top: 1px solid var(--border);
      padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
      display: flex;
      gap: 8px;
    }
    .btn {
      flex: 1;
      padding: 13px;
      border-radius: 12px;
      font-size: 0.95rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
    }
    .btn:active { opacity: 0.8; }
    .btn-outline      { background: var(--bg);  color: var(--green); border: 1.5px solid var(--green-mid); }
    .btn-solid        { background: var(--green); color: white; }
    .btn-fav          { background: #fff1f2; color: #9f1239; border: 1.5px solid #fda4af; }
    .btn-danger       { background: var(--red-bg); color: var(--red-text); border: 1.5px solid #fca5a5; }
    .btn-danger-solid { background: #b91c1c; color: white; }
  </style>
</head>
<body>

<header>
  <h1>ğŸ¥¦ Weekly Meals</h1>
  <p id="week-label"></p>
</header>

<div class="cards" id="cards"></div>

<div class="fav-section" id="fav-section">
  <div class="fav-header">
    <span>â¤ï¸ Saved Meals</span>
    <button class="fav-clear" onclick="clearAllFavs()">Clear all</button>
  </div>
  <div class="fav-body" id="fav-body"></div>
</div>

<div class="grocery-wrap" id="grocery-wrap">
  <div class="grocery-header">
    <span>ğŸ›’ Grocery List</span>
    <button class="clear-checks" onclick="clearChecks()">Clear checks</button>
  </div>
  <div class="grocery-body" id="grocery-body"></div>
</div>

<div class="bottom-bar" id="bottom-bar">
  <button class="btn btn-outline" onclick="askRerollAll()">ğŸ² Reroll All</button>
  <button class="btn btn-fav"     onclick="toggleFavSection()">â¤ï¸ Saved</button>
  <button class="btn btn-solid"   onclick="toggleGrocery()">ğŸ›’ List</button>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// PROTEINS  (American-style, real preparations)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PROTEINS = [

  // â”€â”€ CHICKEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    name: "Garlic butter chicken thighs",
    sides: ["Brown rice", "Roasted potatoes", "Roasted sweet potato", "Quinoa"],
    note: "Season with garlic powder, salt, pepper. Sear skin-down in butter 5â€“6 min until golden. Flip, bake 400Â°F 20â€“25 min.",
    items: { Proteins: ["chicken thighs"], Pantry: ["butter", "garlic powder"] }
  },
  {
    name: "Honey garlic chicken thighs",
    sides: ["White rice", "Brown rice", "Roasted potatoes"],
    note: "Mix 2 tbsp honey + 2 tbsp soy sauce + 4 minced garlic cloves. Bake thighs 400Â°F 30 min, baste with sauce at 15 min.",
    items: { Proteins: ["chicken thighs"], Pantry: ["honey", "soy sauce"], Produce: ["garlic"] }
  },
  {
    name: "BBQ baked chicken thighs",
    sides: ["Roasted potatoes", "Brown rice", "Roasted sweet potato"],
    note: "Coat thighs in BBQ sauce, bake 400Â°F 35â€“40 min. Brush with more sauce last 5 min for sticky glaze.",
    items: { Proteins: ["chicken thighs"], Pantry: ["BBQ sauce"] }
  },
  {
    name: "Paprika roasted chicken thighs",
    sides: ["Brown rice", "Roasted potatoes", "Roasted sweet potato"],
    note: "Mix smoked paprika, garlic powder, cumin, salt + olive oil. Coat thighs. Roast 425Â°F 35 min. Crispy skin, great flavor.",
    items: { Proteins: ["chicken thighs"], Pantry: ["smoked paprika", "cumin", "garlic powder"] }
  },
  {
    name: "Crispy baked chicken tenders",
    sides: ["Roasted potatoes", "Brown rice", "Roasted sweet potato"],
    note: "Dip strips in egg, then breadcrumbs + parmesan + garlic powder. Bake 425Â°F 20 min, flip halfway. Crispy with no frying.",
    items: { Proteins: ["chicken breast"], Pantry: ["breadcrumbs", "parmesan", "garlic powder"], Dairy: ["eggs"] }
  },
  {
    name: "Lemon herb baked chicken breast",
    sides: ["Quinoa", "Brown rice", "Roasted sweet potato", "Fresh fruit"],
    note: "Pound to even thickness. Season with lemon zest, garlic, Italian seasoning, salt + pepper. Bake 400Â°F 20â€“22 min.",
    items: { Proteins: ["chicken breast"], Pantry: ["Italian seasoning"], Produce: ["lemon", "garlic"] }
  },
  {
    name: "Honey mustard chicken breast",
    sides: ["Roasted potatoes", "Brown rice"],
    note: "Mix 2 tbsp Dijon + 2 tbsp honey + olive oil. Coat chicken, bake 400Â°F 22â€“25 min until 165Â°F inside.",
    items: { Proteins: ["chicken breast"], Pantry: ["Dijon mustard", "honey", "olive oil"] }
  },
  {
    name: "Air-fried chicken breast",
    sides: ["Brown rice", "Quinoa", "Roasted sweet potato", "Fresh fruit"],
    note: "Season with garlic powder, paprika, salt, pepper + drizzle of olive oil. Air fry 375Â°F for 18â€“20 min, flip halfway.",
    items: { Proteins: ["chicken breast"], Pantry: ["garlic powder", "paprika", "olive oil"] }
  },
  {
    name: "Simple pan-seared chicken breast",
    sides: ["White rice", "Brown rice", "Roasted potatoes"],
    note: "Pound to even thickness. Season both sides. Sear in olive oil on medium-high 6 min per side. Rest 5 min before slicing.",
    items: { Proteins: ["chicken breast"], Pantry: ["olive oil", "garlic powder"] }
  },
  {
    name: "Rotisserie chicken",
    sides: ["Roasted potatoes", "Brown rice", "Quinoa", "Fresh fruit"],
    note: "Grab one from the store on the way home. Pull the meat off and serve. Zero prep, zero cleanup.",
    items: { Proteins: ["rotisserie chicken (store-bought)"] }
  },

  // â”€â”€ STEAK / BEEF â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    name: "Garlic butter sirloin steak",
    sides: ["Roasted potatoes", "Mashed potatoes", "Roasted sweet potato"],
    note: "Pat dry, season with salt + pepper. Sear in hot cast iron 3â€“4 min/side for medium. Add butter + garlic last minute, baste. Rest 5 min.",
    items: { Proteins: ["sirloin steak"], Pantry: ["butter"], Produce: ["garlic"] }
  },
  {
    name: "Simple salt & pepper ribeye",
    sides: ["Roasted potatoes", "Mashed potatoes"],
    note: "Season generously with only salt + pepper. Cast iron on high, 3â€“4 min/side. Finish with butter. Rest before slicing.",
    items: { Proteins: ["ribeye steak"], Pantry: ["butter"] }
  },
  {
    name: "Korean-style ground beef bowl",
    sides: ["Brown rice", "White rice"],
    note: "Brown beef, drain. Add soy sauce, garlic, ginger, honey, sesame oil. Done in 15 min. Top with sesame seeds + green onion.",
    items: { Proteins: ["lean ground beef (1 lb)"], Pantry: ["soy sauce", "sesame oil", "honey"], Produce: ["garlic", "green onion"] }
  },
  {
    name: "Ground beef taco bowl",
    sides: ["Brown rice", "White rice"],
    note: "Brown lean beef with taco seasoning + onion. Serve over rice with avocado, salsa, lime squeeze.",
    items: { Proteins: ["lean ground beef (1 lb)"], Pantry: ["taco seasoning", "jarred salsa"], Produce: ["onion", "avocado", "lime"] }
  },

  // â”€â”€ SALMON & FISH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    name: "Honey soy glazed salmon",
    sides: ["Brown rice", "White rice", "Quinoa"],
    note: "Mix 2 tbsp honey + 2 tbsp soy sauce + minced garlic. Brush on salmon. Bake 400Â°F 12â€“14 min until it flakes easily.",
    items: { Proteins: ["salmon fillets"], Pantry: ["honey", "soy sauce"], Produce: ["garlic"] }
  },
  {
    name: "Lemon herb baked salmon",
    sides: ["Quinoa", "Brown rice", "Roasted sweet potato", "Fresh fruit"],
    note: "Season with lemon juice, minced garlic, dill or Italian seasoning, salt + pepper. Bake 400Â°F 12â€“15 min. Clean and light.",
    items: { Proteins: ["salmon fillets"], Pantry: ["Italian seasoning"], Produce: ["lemon", "garlic"] }
  },
  {
    name: "Cajun salmon",
    sides: ["Brown rice", "Quinoa", "Roasted potatoes"],
    note: "Coat salmon in Cajun seasoning + olive oil. Pan sear or bake 400Â°F 12â€“14 min. Bold, smoky flavor.",
    items: { Proteins: ["salmon fillets"], Pantry: ["Cajun seasoning", "olive oil"] }
  },
  {
    name: "Garlic butter tilapia",
    sides: ["Brown rice", "Quinoa"],
    note: "Season with garlic powder, paprika, salt. Pan sear in butter + garlic 3â€“4 min/side. Squeeze lemon on top.",
    items: { Proteins: ["tilapia fillets"], Pantry: ["butter", "garlic powder", "paprika"], Produce: ["lemon"] }
  },

  // â”€â”€ SHRIMP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    name: "Garlic butter shrimp",
    sides: ["Brown rice", "Pasta", "Quinoa"],
    note: "SautÃ© shrimp in butter + garlic 2 min/side until pink. Squeeze lemon. Done in under 10 min â€” don't overcook.",
    items: { Proteins: ["shrimp (1 lb, peeled)"], Pantry: ["butter"], Produce: ["garlic", "lemon"] }
  },
  {
    name: "Cajun shrimp",
    sides: ["Brown rice", "Quinoa"],
    note: "Toss shrimp with Cajun seasoning + olive oil. SautÃ© on high heat 2 min/side. Great with rice.",
    items: { Proteins: ["shrimp (1 lb, peeled)"], Pantry: ["Cajun seasoning", "olive oil"] }
  },
  {
    name: "Lemon pepper shrimp",
    sides: ["Brown rice", "Pasta", "Quinoa"],
    note: "Toss shrimp in lemon pepper seasoning + melted butter. Cook in skillet 2â€“3 min/side. Bright and clean.",
    items: { Proteins: ["shrimp (1 lb, peeled)"], Pantry: ["lemon pepper seasoning", "butter"] }
  },

  // â”€â”€ PORK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    name: "Pan-seared pork chops",
    sides: ["Roasted potatoes", "Mashed potatoes", "Brown rice", "Roasted sweet potato"],
    note: "Pat dry, season with garlic powder, salt, pepper. Hot oil in cast iron, 4â€“5 min/side. Don't move them. Rest before cutting.",
    items: { Proteins: ["bone-in pork chops"], Pantry: ["garlic powder", "olive oil"] }
  },
  {
    name: "Honey dijon pork tenderloin",
    sides: ["Roasted potatoes", "Roasted sweet potato", "Brown rice"],
    note: "Mix 2 tbsp Dijon + 2 tbsp honey + minced garlic. Coat tenderloin. Roast 400Â°F 20â€“25 min until 145Â°F inside. Slice thin.",
    items: { Proteins: ["pork tenderloin"], Pantry: ["Dijon mustard", "honey"], Produce: ["garlic"] }
  },

  // â”€â”€ TURKEY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    name: "Ground turkey taco bowl",
    sides: ["Brown rice", "White rice"],
    note: "Brown turkey with taco seasoning + garlic + onion. Serve over rice. Leaner than beef, same great flavor.",
    items: { Proteins: ["ground turkey (1 lb)"], Pantry: ["taco seasoning"], Produce: ["garlic", "onion", "lime"] }
  },
  {
    name: "Baked turkey meatballs",
    sides: ["Whole wheat pasta", "Brown rice"],
    note: "Mix turkey with breadcrumbs, egg, parmesan, Italian seasoning, garlic. Form balls, bake 400Â°F 20 min. Serve with marinara.",
    items: { Proteins: ["ground turkey (1 lb)"], Pantry: ["breadcrumbs", "Italian seasoning", "jarred marinara", "parmesan"], Dairy: ["eggs"] }
  },
];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// VEGGIES
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const VEGGIES = [
  { name: "Steamed broccoli",         items: { Produce: ["broccoli"] } },
  { name: "Roasted asparagus",        items: { Produce: ["asparagus"], Pantry: ["olive oil"] } },
  { name: "SautÃ©ed green beans",      items: { Produce: ["green beans", "garlic"] } },
  { name: "Roasted zucchini",         items: { Produce: ["zucchini"], Pantry: ["olive oil"] } },
  { name: "SautÃ©ed spinach",          items: { Produce: ["baby spinach", "garlic"] } },
  { name: "Roasted bell peppers",     items: { Produce: ["bell peppers"], Pantry: ["olive oil"] } },
  { name: "Steamed corn",             items: { Produce: ["corn on the cob"] } },
  { name: "Roasted carrots",          items: { Produce: ["carrots"], Pantry: ["olive oil", "honey"] } },
  { name: "Roasted Brussels sprouts", items: { Produce: ["Brussels sprouts"], Pantry: ["olive oil"] } },
  { name: "Cucumber & tomato salad",  items: { Produce: ["cucumber", "cherry tomatoes", "lemon"] } },
  { name: "Mixed greens salad",       items: { Produce: ["mixed greens", "cherry tomatoes", "cucumber"] } },
  { name: "Sliced avocado",           items: { Produce: ["avocado"] } },
  { name: "Roasted broccoli",         items: { Produce: ["broccoli"], Pantry: ["olive oil", "garlic powder"] } },
  { name: "SautÃ©ed mushrooms",        items: { Produce: ["mushrooms", "garlic"], Pantry: ["butter"] } },
];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SIDES  (healthy carbs + fruit options)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SIDE_ITEMS = {
  "White rice":          { Pantry: ["white rice"] },
  "Brown rice":          { Pantry: ["brown rice"] },
  "Quinoa":              { Pantry: ["quinoa"] },
  "Whole wheat pasta":   { Pantry: ["whole wheat pasta"] },
  "Roasted potatoes":    { Produce: ["potatoes"],    Pantry: ["olive oil", "garlic powder"] },
  "Mashed potatoes":     { Produce: ["potatoes"],    Dairy: ["butter", "milk"] },
  "Roasted sweet potato":{ Produce: ["sweet potato"],Pantry: ["olive oil"] },
  "Fresh fruit":         { Produce: ["fresh fruit (berries, mango, or melon)"] },
  "Pasta":               { Pantry: ["pasta"] },
};

const DAYS = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STATE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let plan = [];
let FAVORITES = []; // array of { protein, side, veggie } â€” whole meal

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// HELPERS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rand(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

function makeMeal() {
  const protein = rand(PROTEINS);
  return { protein, side: rand(protein.sides), veggie: rand(VEGGIES) };
}

function mealKey(m) { return `${m.protein.name}|${m.side}|${m.veggie.name}`; }
function isMealFav(m) { return FAVORITES.some(f => mealKey(f) === mealKey(m)); }

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// FAVORITES PERSISTENCE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function loadFavorites() {
  try {
    const raw = localStorage.getItem('favMeals');
    if (raw) FAVORITES = JSON.parse(raw);
  } catch (_) {}
}

function saveFavorites() {
  localStorage.setItem('favMeals', JSON.stringify(FAVORITES));
}

function toggleFavorite(i) {
  const meal = plan[i];
  const key  = mealKey(meal);
  const idx  = FAVORITES.findIndex(f => mealKey(f) === key);
  if (idx >= 0) {
    FAVORITES.splice(idx, 1);
  } else {
    FAVORITES.push({ protein: meal.protein, side: meal.side, veggie: meal.veggie });
  }
  saveFavorites();
  render();
  if (document.getElementById('fav-section').classList.contains('open')) buildFavSection();
}

function removeFav(idx) {
  FAVORITES.splice(idx, 1);
  saveFavorites();
  buildFavSection();
  render();
}

function clearAllFavs() {
  FAVORITES = [];
  saveFavorites();
  buildFavSection();
  render();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// RENDER
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function render() {
  const d = new Date();
  document.getElementById('week-label').textContent =
    'Week of ' + d.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });

  const container = document.getElementById('cards');
  container.innerHTML = '';

  plan.forEach((meal, i) => {
    const fav = isMealFav(meal);
    const ytUrl = `https://www.youtube.com/results?search_query=${encodeURIComponent(meal.protein.name + ' recipe')}`;

    const card = document.createElement('div');
    card.className = 'card';
    card.id = `card-${i}`;
    card.innerHTML = `
      <div class="card-header">
        <span class="day-name">${DAYS[i]}</span>
        <div class="card-actions">
          <button class="fav-btn ${fav ? 'active' : ''}" onclick="toggleFavorite(${i})">â¤ï¸</button>
          <button class="reroll-btn" onclick="rerollDay(${i})">ğŸ² Reroll</button>
        </div>
      </div>
      <div class="meal-rows">
        <div class="meal-row">
          <span class="tag tag-p">Protein</span>
          <span class="meal-name">${meal.protein.name}</span>
        </div>
        <div class="meal-row">
          <span class="tag tag-s">Side</span>
          <span class="meal-name">${meal.side}</span>
        </div>
        <div class="meal-row">
          <span class="tag tag-v">Veggie</span>
          <span class="meal-name">${meal.veggie.name}</span>
        </div>
      </div>
      <div class="cook-note">
        ${meal.protein.note}
        <br><a href="${ytUrl}" target="_blank" class="yt-link">â–¶ YouTube tutorial</a>
      </div>
    `;
    container.appendChild(card);
  });

  save();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ACTIONS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let rerollTimer = null;

function askRerollAll() {
  clearTimeout(rerollTimer);
  document.getElementById('bottom-bar').innerHTML = `
    <button class="btn btn-danger"       onclick="cancelRerollAll()">âœ• Cancel</button>
    <button class="btn btn-danger-solid" onclick="doRerollAll()">Yes, reset all</button>
  `;
  rerollTimer = setTimeout(cancelRerollAll, 4000);
}

function cancelRerollAll() {
  clearTimeout(rerollTimer);
  restoreBottomBar();
}

function doRerollAll() {
  clearTimeout(rerollTimer);
  restoreBottomBar();
  plan = DAYS.map(() => makeMeal());
  render();
  closeGrocery();
}

function restoreBottomBar() {
  document.getElementById('bottom-bar').innerHTML = `
    <button class="btn btn-outline" onclick="askRerollAll()">ğŸ² Reroll All</button>
    <button class="btn btn-fav"     onclick="toggleFavSection()">â¤ï¸ Saved</button>
    <button class="btn btn-solid"   onclick="toggleGrocery()">ğŸ›’ List</button>
  `;
}

function rerollDay(i) {
  plan[i] = makeMeal();
  render();
  setTimeout(() => {
    const card = document.getElementById(`card-${i}`);
    if (card) { card.classList.add('rolling'); setTimeout(() => card.classList.remove('rolling'), 300); }
  }, 10);
  if (document.getElementById('grocery-wrap').classList.contains('open')) buildGrocery();
}

function toggleFavSection() {
  const el = document.getElementById('fav-section');
  if (el.classList.contains('open')) {
    el.classList.remove('open');
  } else {
    buildFavSection();
    el.classList.add('open');
    setTimeout(() => el.scrollIntoView({ behavior: 'smooth', block: 'start' }), 50);
  }
}

function buildFavSection() {
  const body = document.getElementById('fav-body');
  if (!FAVORITES.length) {
    body.innerHTML = '<div class="fav-empty">No saved meals yet â€” tap â¤ï¸ on a meal you like.</div>';
    return;
  }
  body.innerHTML = '';
  FAVORITES.forEach((fav, idx) => {
    const row = document.createElement('div');
    row.className = 'fav-item';
    row.innerHTML = `
      <div class="fav-item-info">
        <div class="fav-item-protein">${fav.protein.name}</div>
        <div class="fav-item-sides">${fav.side} Â· ${fav.veggie.name}</div>
      </div>
      <button class="fav-remove" onclick="removeFav(${idx})" title="Remove">âœ•</button>
    `;
    body.appendChild(row);
  });
}

function toggleGrocery() {
  const wrap = document.getElementById('grocery-wrap');
  if (wrap.classList.contains('open')) {
    closeGrocery();
  } else {
    buildGrocery();
    wrap.classList.add('open');
    setTimeout(() => wrap.scrollIntoView({ behavior: 'smooth', block: 'start' }), 50);
  }
}

function closeGrocery() {
  document.getElementById('grocery-wrap').classList.remove('open');
}

function buildGrocery() {
  const lists = { Proteins: new Set(), Produce: new Set(), Pantry: new Set(), Dairy: new Set() };

  plan.forEach(meal => {
    Object.entries(meal.protein.items || {}).forEach(([cat, items]) => (items || []).forEach(i => lists[cat]?.add(i)));
    Object.entries(SIDE_ITEMS[meal.side] || {}).forEach(([cat, items]) => items.forEach(i => lists[cat]?.add(i)));
    Object.entries(meal.veggie.items || {}).forEach(([cat, items]) => (items || []).forEach(i => lists[cat]?.add(i)));
  });

  lists.Pantry.add('olive oil');
  lists.Pantry.add('salt');
  lists.Pantry.add('pepper');

  const body = document.getElementById('grocery-body');
  body.innerHTML = '';

  const catLabels = { Proteins: 'Proteins & Fish', Produce: 'Produce', Pantry: 'Pantry & Spices', Dairy: 'Dairy' };
  for (const [cat, label] of Object.entries(catLabels)) {
    const items = [...lists[cat]].filter(Boolean).sort();
    if (!items.length) continue;
    const div = document.createElement('div');
    div.className = 'g-category';
    div.innerHTML = `<h3>${label}</h3>`;
    items.forEach(item => {
      const row = document.createElement('label');
      row.className = 'g-item';
      row.innerHTML = `<input type="checkbox" onchange="this.closest('.g-item').classList.toggle('checked', this.checked)"><span>${item}</span>`;
      div.appendChild(row);
    });
    body.appendChild(div);
  }
}

function clearChecks() {
  document.querySelectorAll('.g-item').forEach(el => {
    el.classList.remove('checked');
    el.querySelector('input').checked = false;
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// PERSISTENCE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function save() {
  const data = plan.map(m => ({
    protein: { name: m.protein.name, sides: m.protein.sides, note: m.protein.note, items: m.protein.items },
    side: m.side,
    veggie: { name: m.veggie.name, items: m.veggie.items },
  }));
  localStorage.setItem('mealPlan', JSON.stringify({ date: new Date().toDateString(), data }));
}

function load() {
  try {
    const raw = localStorage.getItem('mealPlan');
    if (!raw) return false;
    const { date, data } = JSON.parse(raw);
    if (date !== new Date().toDateString()) return false;
    if (!data[0]?.protein?.name) return false;
    plan = data.map(d => ({ protein: d.protein, side: d.side, veggie: d.veggie }));
    return true;
  } catch { return false; }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// INIT
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
loadFavorites();
if (!load()) { plan = DAYS.map(() => makeMeal()); }
render();
</script>
</body>
</html>
